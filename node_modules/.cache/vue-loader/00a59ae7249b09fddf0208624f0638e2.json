{"remainingRequest":"C:\\Users\\86182\\AppData\\Roaming\\npm\\node_modules\\@vue\\cli-service-global\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\86182\\Desktop\\puzzle-demo\\Puzzle.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\86182\\Desktop\\puzzle-demo\\Puzzle.vue","mtime":1578363926600},{"path":"C:\\Users\\86182\\AppData\\Roaming\\npm\\node_modules\\@vue\\cli-service-global\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\86182\\AppData\\Roaming\\npm\\node_modules\\@vue\\cli-service-global\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\86182\\AppData\\Roaming\\npm\\node_modules\\@vue\\cli-service-global\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogIHByb3BzOiB7DQogICAgd2lkdGg6IHsNCiAgICAgIHR5cGU6IE51bWJlciwNCiAgICAgIGRlZmF1bHQ6IDUwMA0KICAgIH0sDQogICAgaGVpZ2h0OiB7DQogICAgICB0eXBlOiBOdW1iZXIsDQogICAgICBkZWZhdWx0OiA1MDANCiAgICB9LA0KICAgIHJvdzogew0KICAgICAgdHlwZTogTnVtYmVyLA0KICAgICAgZGVmYXVsdDogMw0KICAgIH0sDQogICAgY29sOiB7DQogICAgICB0eXBlOiBOdW1iZXIsDQogICAgICBkZWZhdWx0OiAzDQogICAgfSwNCiAgICBpbWc6IHsNCiAgICAgIHR5cGU6IFN0cmluZywNCiAgICAgIHJlcXVpcmVkOiB0cnVlDQogICAgfQ0KICB9LA0KDQogIGNvbXB1dGVkOiB7DQogICAgYmxvY2tXaWR0aCgpIHsNCiAgICAgIHJldHVybiB0aGlzLndpZHRoIC8gdGhpcy5jb2w7DQogICAgfSwNCiAgICBibG9ja0hlaWdodCgpIHsNCiAgICAgIHJldHVybiB0aGlzLmhlaWdodCAvIHRoaXMucm93Ow0KICAgIH0sDQogICAgY3VycmVjdFBvaW50cygpIHsNCiAgICAgIGNvbnN0IHsgcm93LCBjb2wsIGJsb2NrV2lkdGgsIGJsb2NrSGVpZ2h0IH0gPSB0aGlzOw0KICAgICAgY29uc3QgYXJyID0gW107DQoNCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcm93OyBpKyspIHsNCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBjb2w7IGorKykgew0KICAgICAgICAgIGFyci5wdXNoKHsNCiAgICAgICAgICAgIHg6IGogKiBibG9ja1dpZHRoLA0KICAgICAgICAgICAgeTogaSAqIGJsb2NrSGVpZ2h0LA0KICAgICAgICAgICAgaWQ6IG5ldyBEYXRlKCkuZ2V0VGltZSgpICsgTWF0aC5yYW5kb20oKSAqIDEwMA0KICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICB9DQogICAgICByZXR1cm4gYXJyOw0KICAgIH0sDQogICAgYmxvY2tQb2ludHMoKSB7DQogICAgICBjb25zdCBwb2ludHMgPSB0aGlzLmN1cnJlY3RQb2ludHM7DQogICAgICBjb25zdCBsZW5ndGggPSBwb2ludHMubGVuZ3RoOw0KICAgICAgY29uc3QgbGFzdEVsZSA9IHBvaW50c1tsZW5ndGggLSAxXTsNCiAgICAgIGNvbnN0IG5ld0FyciA9IFsuLi5wb2ludHNdOw0KICAgICAgbmV3QXJyLmxlbmd0aCA9IGxlbmd0aCAtIDE7DQogICAgICBuZXdBcnIuc29ydCgoKSA9PiBNYXRoLnJhbmRvbSgpIC0gMC41KTsNCiAgICAgIG5ld0Fyci5wdXNoKGxhc3RFbGUpOw0KICAgICAgcmV0dXJuIG5ld0FycjsNCiAgICB9DQogIH0sDQoNCiAgbWV0aG9kczogew0KICAgIGhhbmRsZUNsaWNrKGUpIHsNCiAgICAgIGNvbnN0IGJsb2NrRG9tID0gZS50YXJnZXQ7DQogICAgICBjb25zdCBlbXB0eURvbSA9IHRoaXMuJHJlZnMuZW1wdHlbMF07DQogICAgICBpZiAoIXRoaXMuaXNBZGphY2VudChibG9ja0RvbSwgZW1wdHlEb20pKSB7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICAgIGNvbnN0IHsgbGVmdCwgdG9wIH0gPSBibG9ja0RvbS5zdHlsZTsNCiAgICAgIGJsb2NrRG9tLnN0eWxlLmxlZnQgPSBlbXB0eURvbS5zdHlsZS5sZWZ0Ow0KICAgICAgYmxvY2tEb20uc3R5bGUudG9wID0gZW1wdHlEb20uc3R5bGUudG9wOw0KICAgICAgZW1wdHlEb20uc3R5bGUubGVmdCA9IGxlZnQ7DQogICAgICBlbXB0eURvbS5zdHlsZS50b3AgPSB0b3A7DQogICAgICBjb25zdCB3aW5GbGFnID0gdGhpcy5jaGVja1dpbigpOw0KICAgICAgaWYgKHdpbkZsYWcpIHsNCiAgICAgICAgdGhpcy53aW5HYW1lKGVtcHR5RG9tKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIGlzQWRqYWNlbnQoYmxvY2tEb20sIGVtcHR5RG9tKSB7DQogICAgICBjb25zdCB7IGxlZnQ6IGRvbUxlZnQsIHRvcDogZG9tVG9wLCB3aWR0aCwgaGVpZ2h0IH0gPSBibG9ja0RvbS5zdHlsZTsNCiAgICAgIGNvbnN0IHsgbGVmdDogZW1wdHlMZWZ0LCB0b3A6IGVtcHR5VG9wIH0gPSBlbXB0eURvbS5zdHlsZTsNCiAgICAgIGNvbnN0IHhEaXMgPSBNYXRoLmZsb29yKA0KICAgICAgICBNYXRoLmFicyhwYXJzZUZsb2F0KGRvbUxlZnQpIC0gcGFyc2VGbG9hdChlbXB0eUxlZnQpKQ0KICAgICAgKTsNCiAgICAgIGNvbnN0IHlEaXMgPSBNYXRoLmZsb29yKA0KICAgICAgICBNYXRoLmFicyhwYXJzZUZsb2F0KGRvbVRvcCkgLSBwYXJzZUZsb2F0KGVtcHR5VG9wKSkNCiAgICAgICk7DQogICAgICBjb25zdCBmbGFnID0NCiAgICAgICAgKGRvbUxlZnQgPT09IGVtcHR5TGVmdCAmJiB5RGlzID09PSBwYXJzZUludChoZWlnaHQpKSB8fA0KICAgICAgICAoZG9tVG9wID09PSBlbXB0eVRvcCAmJiB4RGlzID09PSBwYXJzZUludCh3aWR0aCkpOw0KICAgICAgcmV0dXJuIGZsYWc7DQogICAgfSwNCiAgICBjaGVja1dpbigpIHsNCiAgICAgIGNvbnN0IGJsb2NrRG9tQXJyID0gdGhpcy4kcmVmcy5ibG9jazsNCiAgICAgIHJldHVybiBibG9ja0RvbUFyci5ldmVyeShkb20gPT4gew0KICAgICAgICBjb25zdCB7IGxlZnQ6IGRvbUxlZnQsIHRvcDogZG9tVG9wIH0gPSBkb20uc3R5bGU7DQogICAgICAgIGNvbnN0IHsgY29ycmVjdHg6IGNvcnJlY3RYLCBjb3JyZWN0eTogY29ycmVjdFkgfSA9IGRvbS5kYXRhc2V0Ow0KICAgICAgICBjb25zdCBmbGFnID0NCiAgICAgICAgICBwYXJzZUludChkb21MZWZ0KSA9PT0gcGFyc2VJbnQoY29ycmVjdFgpICYmDQogICAgICAgICAgcGFyc2VJbnQoZG9tVG9wKSA9PT0gcGFyc2VJbnQoY29ycmVjdFkpOw0KICAgICAgICByZXR1cm4gZmxhZzsNCiAgICAgIH0pOw0KICAgIH0sDQogICAgd2luR2FtZShlbXB0eURvbSkgew0KICAgICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgIGFsZXJ0KCLov4flhbPkuoYiKTsNCiAgICAgICAgZW1wdHlEb20uc3R5bGUub3BhY2l0eSA9IDE7DQogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgIHRoaXMuZ29Ub05leHRMZXZlbCgpOw0KICAgICAgICB9LCAzMDApOw0KICAgICAgfSwgMzAwKTsNCiAgICB9LA0KICAgIGdvVG9OZXh0TGV2ZWwoKSB7DQogICAgICBjb25zdCBhbnN3ZXJGbGFnID0gd2luZG93LmNvbmZpcm0oIuimgeeOqeS4i+S4gOWFs+WQl++8nyIpOw0KICAgICAgaWYgKGFuc3dlckZsYWcpIHsNCiAgICAgICAgdGhpcy4kZW1pdCgibmV4dCIpOw0KICAgICAgfQ0KICAgIH0NCiAgfQ0KfTsNCg=="},{"version":3,"sources":["Puzzle.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAwBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Puzzle.vue","sourceRoot":".","sourcesContent":["<template>\r\n  <div class=\"puzzle\" :style=\"{width: width + 'px',height: height + 'px'}\">\r\n    <div\r\n      class=\"puzzle__block\"\r\n      v-for=\"(item,index) in blockPoints\"\r\n      :key=\"item.id\"\r\n      :style=\"{\r\n    width: blockWidth + 'px',\r\n    height: blockHeight + 'px',\r\n    left: item.x+'px',\r\n    top: item.y+'px',\r\n    backgroundImage: `url(${img})`,\r\n    backgroundPosition: `-${currectPoints[index].x}px -${currectPoints[index].y}px`,\r\n    opacity: index === blockPoints.length - 1 && 0\r\n    }\"\r\n      @click=\"handleClick\"\r\n      :ref=\"index === blockPoints.length-1 ? 'empty' : 'block'\"\r\n      :data-correctX=\"currectPoints[index].x\"\r\n      :data-correctY=\"currectPoints[index].y\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  props: {\r\n    width: {\r\n      type: Number,\r\n      default: 500\r\n    },\r\n    height: {\r\n      type: Number,\r\n      default: 500\r\n    },\r\n    row: {\r\n      type: Number,\r\n      default: 3\r\n    },\r\n    col: {\r\n      type: Number,\r\n      default: 3\r\n    },\r\n    img: {\r\n      type: String,\r\n      required: true\r\n    }\r\n  },\r\n\r\n  computed: {\r\n    blockWidth() {\r\n      return this.width / this.col;\r\n    },\r\n    blockHeight() {\r\n      return this.height / this.row;\r\n    },\r\n    currectPoints() {\r\n      const { row, col, blockWidth, blockHeight } = this;\r\n      const arr = [];\r\n\r\n      for (let i = 0; i < row; i++) {\r\n        for (let j = 0; j < col; j++) {\r\n          arr.push({\r\n            x: j * blockWidth,\r\n            y: i * blockHeight,\r\n            id: new Date().getTime() + Math.random() * 100\r\n          });\r\n        }\r\n      }\r\n      return arr;\r\n    },\r\n    blockPoints() {\r\n      const points = this.currectPoints;\r\n      const length = points.length;\r\n      const lastEle = points[length - 1];\r\n      const newArr = [...points];\r\n      newArr.length = length - 1;\r\n      newArr.sort(() => Math.random() - 0.5);\r\n      newArr.push(lastEle);\r\n      return newArr;\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    handleClick(e) {\r\n      const blockDom = e.target;\r\n      const emptyDom = this.$refs.empty[0];\r\n      if (!this.isAdjacent(blockDom, emptyDom)) {\r\n        return;\r\n      }\r\n      const { left, top } = blockDom.style;\r\n      blockDom.style.left = emptyDom.style.left;\r\n      blockDom.style.top = emptyDom.style.top;\r\n      emptyDom.style.left = left;\r\n      emptyDom.style.top = top;\r\n      const winFlag = this.checkWin();\r\n      if (winFlag) {\r\n        this.winGame(emptyDom);\r\n      }\r\n    },\r\n    isAdjacent(blockDom, emptyDom) {\r\n      const { left: domLeft, top: domTop, width, height } = blockDom.style;\r\n      const { left: emptyLeft, top: emptyTop } = emptyDom.style;\r\n      const xDis = Math.floor(\r\n        Math.abs(parseFloat(domLeft) - parseFloat(emptyLeft))\r\n      );\r\n      const yDis = Math.floor(\r\n        Math.abs(parseFloat(domTop) - parseFloat(emptyTop))\r\n      );\r\n      const flag =\r\n        (domLeft === emptyLeft && yDis === parseInt(height)) ||\r\n        (domTop === emptyTop && xDis === parseInt(width));\r\n      return flag;\r\n    },\r\n    checkWin() {\r\n      const blockDomArr = this.$refs.block;\r\n      return blockDomArr.every(dom => {\r\n        const { left: domLeft, top: domTop } = dom.style;\r\n        const { correctx: correctX, correcty: correctY } = dom.dataset;\r\n        const flag =\r\n          parseInt(domLeft) === parseInt(correctX) &&\r\n          parseInt(domTop) === parseInt(correctY);\r\n        return flag;\r\n      });\r\n    },\r\n    winGame(emptyDom) {\r\n      setTimeout(() => {\r\n        alert(\"过关了\");\r\n        emptyDom.style.opacity = 1;\r\n        setTimeout(() => {\r\n          this.goToNextLevel();\r\n        }, 300);\r\n      }, 300);\r\n    },\r\n    goToNextLevel() {\r\n      const answerFlag = window.confirm(\"要玩下一关吗？\");\r\n      if (answerFlag) {\r\n        this.$emit(\"next\");\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n<style>\r\n.puzzle {\r\n  position: relative;\r\n  border: 2px solid #ccc;\r\n}\r\n.puzzle__block {\r\n  position: absolute;\r\n  border: 0.5px solid #fff;\r\n  box-sizing: border-box;\r\n  transition: all 0.3s;\r\n}\r\n</style>"]}]}